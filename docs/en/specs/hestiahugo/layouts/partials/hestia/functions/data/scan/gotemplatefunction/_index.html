+++
date = "2022-07-18T08:20:19+08:00"
title = "GoTemplateFunction - HestiaHUGO's Internal Partial Function"
description = """
HestiaHUGO's internal partial function 'GoTemplateFunction' is responsible for
rendering string query using go template functions. This is its technical
specification intended for future maintenances and development usage.
"""
Keywords = [
	"GoTemplateFunction",
	"Scans",
	"Data",
	"Functions",
	"Hestia",
	"Partials",
	"Layouts",
	"Specifications",
	"HestiaHUGO",
	"ZORALab's Hestia",
	"Official Website",
	"ZORALab Enterprise",
	"ZORALab",
]
draft = false
layout = "single"

[menu.main]
parent = "Hestia's Partial Functions"
identifer = "hestia-partials-functions-data-scan-gotemplatefunction"
name = "Data Scanner | GoTemplateFunction"
Pre = ""
weight = 1
+++

<section id="introduction">
	<h1>{{% param "title" %}}</h1>
	<p>
		{{% param "description" %}}
	</p>
</section>




<section id="objective-and-purposes">
	<h2>Objective and Purposes</h2>
	<p>
		The primary objective of this function is allowing one to
		perform Go template functions in non-partial layout
		environments.
		<br/><br/>
		Some good use cases would be <code>string</code> data where it
		is heavily used in processing page parameters or data fields.
		With this function, all supported fields can access page
		variables and <a href="{{% Hestia/url URL="/specs/hestiahugo/layouts/partials/hestia/shortcodes" Lang="en" /%}}">
		Hestia Partial Shortcodes Functions</a> in a controlled pattern.
		<br/><br/>
		Example, supported data fields can now use
		<code>{{- .Titles.Page -}}</code> or
		<code>{{- url URL="..." Lang="en" -}}</code> in the TOML data
		file rather than manually typing each of them.
	</p>
</section>




<section id="how-it-works">
	<h2>How It Works</h2>
	<p>
		Generally, it works by scanning the a given string data
		(<code>.Input.Query</code> from a Hestia <code>.Page</code> data
		structure) against a known Go template clause pattern. The
		function extracts all the clauses along with the designated
		whitespace for eliminations, process their outputs and then
		replace their respective clauses before returning as output.
	</p>


	<section id="input">
		<h3>Input</h3>
		<p>
			This partial function accepts the following inputs:
			<ul>
				<li><p>
					<b><code>.Page</b></code> - required
					Hestia Page data structure.
				</p></li>
				<li><p>
					<b><code>.Page.Input.Query</b></code> -
					The queried string for processing.
				</p></li>
			</ul>
		</p>
	</section>


	<section id="algorithm">
		<h3>Working Algorithm</h3>
		<p>
			This partial function works in the following manner:
			<ol>
				<li><p>
					Scan the <code>.Page.Input.Query</code>
					for a list of Go template function
					clauses along with the specified
					whitespace eliminations using Hugo's
					<a href="https://gohugo.io/functions/findre/">
					<code>findRE</code></a> function and
					<code>((?:\{\{|\s*\{\{\-)(.*?)(?:\}\}|-\}\}\s*))</code>
					regex pattern.
				</p></li>
				<li><p>
					Organize every clauses in a
					<code>key:value</code> data structure
					where the <code>key</code> shall be used
					for the actual clause replacement and
					<code>value</code> is a processed slice
					data where the first in the slice is a
					function.
				</p></li>
				<li><p>
					Process each <code>value</code> by
					analyzing its function nature (either
					data filling with period
					(<code>.</code>) prefix or a function.
					If it is data filling, the clause shall
					be processed by
					<a href="{{% Hestia/url URL="/specs/hestiahugo/layouts/partials/hestia/functions/data/scan/variable/" Lang="en" /%}}">
					Data/Scan/Variables Hestia Partial
					Function</a>. Otherwise, it shall
					assumes it is a function call into
					any of the <a href="{{% Hestia/url URL="/specs/hestiahugo/layouts/partials/hestia/shortcodes" Lang="en" /%}}">Hestia Partial Shortcodes
					Function</a> and then forming the
					partial filepath with the function name
					alongside its arguments processed as
					<code>.Page.Input</code> before feeding
					into the partial functions. The output
					are then updated to the
					<code>value</code> field.
				</p></li>
				<li><p>
					The <code>.Page.Input.Query</code> data
					is replaced by the processed
					<code>key:value</code> map list using
					<a href="https://gohugo.io/functions/replace/">
					Hugo's replace function</a>.
				</p></li>
				<li><p>
					Return the processed data as
					<code>string</code> type.
				</p></li>
			</ol>
		</p>
	</section>


	<section id="output">
		<h3>Output</h3>
		<p>
			This function returns all the following possible
			outputs:
		</p>
		<ul>
			<li><p>
				<code>OK</code> - processed string output.
			</p></li>
			<li><p>
				<code>ERROR - missing partial function</code> -
				a template clause calls a missing or invalid
				Hestia partial shortcode function. Returned
				string is unusable and chaotic in nature.
			</p></li>
			<li><p>
				<code>ERROR - improper clauses</code> -
				a template clause is usable but the clause
				pattern does not conforms with Go Template
				formatting pattern. Returned string is usable
				if good since this error is a notice and it is
				not a rejection.
			</p></li>
		</ul>
	</section>


	<section id="known-issues">
		<h3>Known Issues</h3>
		<p>
			Here are some of the known issues.
		</p>
		<ul>
			<li><p>
				Due to the use of regex pattern matching and
				Hugo partial features, one can use a distorted
				Go template clause (e.g. missing 1 space
				character requirement between the opening or
				closing braces). While this function raise
				an error reporting to the console, it does not
				reject the processing since both Hugo and Go
				Template does not offer early exit function.
			</p></li>
			<li></p>
				Despite being as closely compatible to Go
				template clause, it accepts arguments exactly
				the same as Hugo's shortcodes. This is limited
				by the available functions offered by Go
				template packages and Hugo functions. There is
				a thought of using Hugo shortcode patterns
				(e.g. <code>{{%/* ... */%}}</code>) but was
				rejected to avoid confusion because this
				function only operates at partial layouts scope.
			</p></li>
			<li></p>
				Due to the inability to return early in Go
				template packages, all error reporting are
				served as a notice and not a rejection.
			</p></li>
		</ul>
	</section>
</section>


<section id="usage">
	<h2>Usage</h2>
	<p>
		To use this partial function, simply formulate your intended
		query data and then feed it into the partial functions. Example:
		assuming the page context is a Hestia processed Page data
		structure, to get a page title from the Hestia Page variables:
	</p>
{{% highlight html "linenos=table,hl_lines=,linenostart=1" %}}
	{{- $HestiaPage := . -}}
	{{- $dataList := dict "Query" "My Page title is {{- .Title.Page -}}" -}}
	{{- $dataList = dict "Input" $dataList -}}
	{{- $dataList = merge $HestiaPage $dataList -}}
	{{- $ret := partial "Hestia/functions/data/scan/GoTemplateFunction" $dataList -}}
{{% /highlight %}}


	<p>
		To call a hestia partial shortocode function, example, calling
		the <code>url</code> function:
	</p>
{{% highlight html "linenos=table,hl_lines=,linenostart=1" %}}
	{{- $HestiaPage := . -}}
	{{- $dataList := dict "Query" "My link: {{ url URL="/secret-page" Lang="en" -}}" -}}
	{{- $dataList = dict "Input" $dataList -}}
	{{- $dataList = merge $HestiaPage $dataList -}}
	{{- $ret := partial "Hestia/functions/data/scan/GoTemplateFunction" $dataList -}}
{{% /highlight %}}
</section>




<section id="epilogue">
	<h2>Epilogue</h2>
	<p>
		That's all for {{% param "title" %}}.
	</p>
</section>
